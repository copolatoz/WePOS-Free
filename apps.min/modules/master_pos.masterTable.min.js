/**
 * Filename: master_pos.masterTable.js
 * Generated 2019-03-07 at 12:55:29 AM
 */
Ext.define('ExtApp.modules.master_pos.model.model_masterTable',{extend:'Ext.data.Model',alias:'model_masterTable',fields:[{name:'id',type:'int'},{name:'table_name',type:'string'},{name:'table_desc',type:'string'},{name:'table_no',type:'string'},{name:'room_name',type:'string'},{name:'room_no',type:'string'},{name:'room_id',type:'int'},{name:'floorplan_name',type:'string'},{name:'floorplan_id',type:'int'},{name:'kapasitas',type:'int'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'table_tipe',type:'string'},{name:'table_tipe_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterTable/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterRoom',{extend:'Ext.data.Model',alias:'model_masterRoom',fields:[{name:'id',type:'int'},{name:'room_name',type:'string'},{name:'room_desc',type:'string'},{name:'room_no',type:'string'},{name:'floorplan_name',type:'string'},{name:'floorplan_id',type:'int'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterRoom/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterFloorplan',{extend:'Ext.data.Model',alias:'model_masterFloorplan',fields:[{name:'id',type:'int'},{name:'floorplan_name',type:'string'},{name:'floorplan_desc',type:'string'},{name:'floorplan_image',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterFloorplan/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_reservationTipe',{extend:'Ext.data.Model',alias:'model_reservationTipe',fields:[{name:'id',type:'int'},{name:'name',type:'string'},{name:'val',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/reservationTipe/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.store.store_masterTable',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterTable',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterRoom',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterRoom',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterFloorplan',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterFloorplan',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_reservationTipe',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_reservationTipe',autoLoad:false,remoteSort:true});Ext.define("ExtApp.modules.master_pos.view.masterTable",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var store_masterTable_masterTable=theApp.getStore('store_masterTable_masterTable',false);if(store_masterTable_masterTable==false){store_masterTable_masterTable=theApp.copyStore('master_pos','store_masterTable','store_masterTable_masterTable');}
store_masterTable_masterTable.proxy.extraParams.limit=25;store_masterTable_masterTable.proxy.extraParams.show_all_text=0;store_masterTable_masterTable.proxy.extraParams.show_choose_text=0;store_masterTable_masterTable.proxy.extraParams.is_dropdown=0;store_masterTable_masterTable.proxy.extraParams.is_active=1;store_masterTable_masterTable.proxy.extraParams.keywords='';var helperGrid=theApp.getHelper('Grid');var selModel_masterTable=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_masterTable').down('#deleteButton_masterTable').setDisabled(selections.length==0);}}});me.pagingtb_masterTable=helperGrid.paging({ds:store_masterTable_masterTable,title:'Master Table'});return desktop.createWindow({id:me.id,title:'Master Table',width:730,height:400,iconCls:'icon-building',animCollapse:false,constrainHeader:true,resizable:true,maximized:false,border:0,layout:{type:'fit'},items:[{xtype:'gridpanel',id:'grid_masterTable',store:store_masterTable_masterTable,scroll:true,selModel:selModel_masterTable,columns:[{xtype:'gridcolumn',dataIndex:'id',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'floorplan_id',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'room_id',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'table_name',text:'Nama Meja',width:150},{xtype:'gridcolumn',dataIndex:'table_tipe_text',text:'Tipe',width:100},{xtype:'gridcolumn',dataIndex:'table_no',text:'No.Meja',width:100},{xtype:'gridcolumn',dataIndex:'room_no',text:'No.Ruangan',width:100},{xtype:'gridcolumn',dataIndex:'room_name',text:'Ruangan',width:100},{xtype:'gridcolumn',dataIndex:'kapasitas',text:'Kapasitas',width:80},{xtype:'gridcolumn',dataIndex:'floorplan_name',text:'Floorplan/Lantai',width:150},{xtype:'gridcolumn',dataIndex:'table_desc',text:'Note',width:150},{xtype:'gridcolumn',dataIndex:'is_active_text',text:'Status',width:70}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_masterTable').getSelectionModel().selected;if(getSelection.length>0){me.formType='edit';me.edit_data=getSelection.items[0].data;me.createWindow(me,'add_masterTable');}}},bbar:me.pagingtb_masterTable,dockedItems:[{xtype:'toolbar',dock:'top',items:[{xtype:'textfield',name:'keywords',id:'keywords_masterTable',width:200,labelSeparator:'',emptyText:'Keywords: Meja/Ruangan/Lantai',anchor:'100%',listeners:{specialkey:function(field,e){if(e.getKey()==e.ENTER){me.search_masterTable();}}}},{xtype:'button',text:'Search',itemId:'btnFilterSearch_masterTable',tooltip:'Search',iconCls:'btn-search',handler:function(){me.search_masterTable();}},{xtype:'button',text:'Reset',itemId:'btnResetFilterSearch_masterTable',tooltip:'Reset',iconCls:'btn-reset',handler:function(){me.search_masterTable(true);}},'->',{text:'Add',itemId:'addButton_masterTable',tooltip:'Add New Master Table',iconCls:'btn-add',handler:function(){me.formType='add';me.createWindow(me,'add_masterTable');}},'-',{text:'Delete',itemId:'deleteButton_masterTable',tooltip:'Delete Master Table',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_masterTable').getSelectionModel().selected;if(getSelection.length>0){me.delete_data=getSelection.items[0].data;me.deleteConfirm_masterTable();}else{ExtApp.Msg.info('Please Select Master Table!');}}},]}]}],listeners:{boxready:function(){me.search_masterTable();}}});},add_masterTable:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add Master Table ';if(me.formType=='edit'){Titletext='Update Master Table: ';}
var store_masterFloorplan_masterTable=theApp.getStore('store_masterFloorplan_masterTable',false);if(store_masterFloorplan_masterTable==false){store_masterFloorplan_masterTable=theApp.copyStore('master_pos','store_masterFloorplan','store_masterFloorplan_masterTable');}
store_masterFloorplan_masterTable.proxy.extraParams.limit=99999;store_masterFloorplan_masterTable.proxy.extraParams.show_all_text=0;store_masterFloorplan_masterTable.proxy.extraParams.show_choose_text=1;store_masterFloorplan_masterTable.proxy.extraParams.is_dropdown=1;store_masterFloorplan_masterTable.proxy.extraParams.is_active=1;var store_masterRoom_masterTable=theApp.getStore('store_masterRoom_masterTable',false);if(store_masterRoom_masterTable==false){store_masterRoom_masterTable=theApp.copyStore('master_pos','store_masterRoom','store_masterRoom_masterTable');}
store_masterRoom_masterTable.proxy.extraParams.limit=99999;store_masterRoom_masterTable.proxy.extraParams.show_all_text=0;store_masterRoom_masterTable.proxy.extraParams.show_choose_text=1;store_masterRoom_masterTable.proxy.extraParams.is_dropdown=1;store_masterRoom_masterTable.proxy.extraParams.is_active=1;store_masterRoom_masterTable.proxy.extraParams.floorplan_id=0;var tableTipe_masterTable=theApp.getStore('tableTipe_masterTable',false);if(tableTipe_masterTable==false){tableTipe_masterTable=theApp.copyStore('master_pos','store_reservationTipe','tableTipe_masterTable');}
tableTipe_masterTable.proxy.extraParams.show_choose_text=0;tableTipe_masterTable.proxy.extraParams.show_all_text=0;return desktop.createWindow({id:me.id+'_add_masterTable',title:Titletext,width:350,height:330,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_masterTable',border:0,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'hidden',name:'form_type_masterTable',value:me.formType},{xtype:'hidden',name:'id'},{xtype:'hidden',name:'floorplan_id'},{xtype:'hidden',name:'room_id'},{xtype:'combobox',name:'table_tipe',id:'table_tipe_masterTable',fieldLabel:'Tipe',emptyText:'Pilih',anchor:'100%',store:tableTipe_masterTable,queryMode:'local',hiddenName:"val",displayField:'name',valueField:'val',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listeners:{select:function(combo,records,eOpts){}}},{xtype:'combobox',name:'select_floorplan_id',id:'select_floorplan_id_masterTable',fieldLabel:'Lantai',anchor:'100%',store:store_masterFloorplan_masterTable,queryMode:'local',hiddenName:"floorplan_id",displayField:'floorplan_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listConfig:{emptyText:'Tidak ada data',minWidth:250,getInnerTpl:function(){return'{floorplan_name}';}},pageSize:0,listeners:{select:function(combo,records,eOpts){var form=Ext.getCmp('form_masterTable').getForm();form.findField('floorplan_id').setValue(records[0].data.id);form.findField('room_id').setValue(0);store_masterRoom_masterTable.proxy.extraParams.floorplan_id=records[0].data.id;store_masterRoom_masterTable.load();}}},{xtype:'combobox',name:'select_room_id',id:'select_room_id_masterTable',fieldLabel:'Ruangan',anchor:'100%',store:store_masterRoom_masterTable,queryMode:'local',hiddenName:"room_id",displayField:'room_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,listConfig:{emptyText:'Tidak ada data',minWidth:250,getInnerTpl:function(){return'{room_name}';}},pageSize:0,listeners:{select:function(combo,records,eOpts){var form=Ext.getCmp('form_masterTable').getForm();form.findField('room_id').setValue(records[0].data.id);}}},{xtype:'textfield',name:'table_name',fieldLabel:'Nama Meja',anchor:'100%',allowBlank:false},{xtype:'textfield',name:'table_no',fieldLabel:'No Meja',anchor:'100%',allowBlank:false},{xtype:'numberfield',name:'kapasitas',fieldLabel:'Kapasitas (org)',minValue:1,width:170},{xtype:'textfield',name:'table_desc',fieldLabel:'Description',anchor:'100%'},{xtype:'checkbox',name:'is_active',fieldLabel:'Status Active',inputValue:'1'}]}],buttons:[{text:'Save',formBind:true,id:'btnSave_masterTable',iconCls:'btn-save',handler:function(){me.save_masterTable();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_masterTable');}}],listeners:{show:function(){var form=Ext.getCmp('form_masterTable').getForm();var myMask=new Ext.LoadMask(Ext.getCmp('form_masterTable'),{msg:"Loading..."});myMask.show();if(me.formType=='edit'){form.setValues(me.edit_data);}else{form.reset();form.findField('is_active').setValue(1);}
store_masterFloorplan_masterTable.load({params:{show_choose_text:1},callback:function(records,operation,success){var floorplan_id=-1;var floorplan_name='';if(me.formType=='edit'){floorplan_id=me.edit_data.floorplan_id;floorplan_name=me.edit_data.floorplan_name;store_masterRoom_masterTable.proxy.extraParams.floorplan_id=me.edit_data.floorplan_id;}
Ext.getCmp('select_floorplan_id_masterTable').select(floorplan_id);store_masterRoom_masterTable.load({params:{show_choose_text:1},callback:function(records,operation,success){var room_id=-1;var room_name='';if(me.formType=='edit'){room_id=me.edit_data.room_id;room_name=me.edit_data.room_name;}
Ext.getCmp('select_room_id_masterTable').select(room_id);myMask.hide();}});}});tableTipe_masterTable.load({params:{show_choose_text:1},callback:function(records,operation,success){table_tipe='dinein';if(me.formType=='edit'){table_tipe=me.edit_data.table_tipe;}
Ext.getCmp('table_tipe_masterTable').select(table_tipe);}});}}});}});