/**
 * Filename: master_pos.masterBank.js
 * Generated 2018-08-27 at 06:52:37 PM
 */
Ext.define('ExtApp.modules.master_pos.model.model_masterBank',{extend:'Ext.data.Model',alias:'model_masterBank',fields:[{name:'id',type:'int'},{name:'bank_code',type:'string'},{name:'bank_name',type:'string'},{name:'payment_id',type:'int'},{name:'payment_text',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterBank/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_paymentType',{extend:'Ext.data.Model',alias:'model_paymentType',fields:[{name:'id',type:'int'},{name:'payment_type_name',type:'string'},{name:'payment_type_desc',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/paymentType/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.store.store_masterBank',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterBank',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_paymentType',{extend:'Ext.data.Store',fields:['val','name'],data:[{"val":"cash","name":"Cash","id":1},{"val":"debit","name":"Debit Card","id":2},{"val":"credit","name":"Credit Card","id":3},],autoLoad:false});Ext.define("ExtApp.modules.master_pos.view.masterBank",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var store_masterBank_masterBank=theApp.getStore('store_masterBank_masterBank',false);if(store_masterBank_masterBank==false){store_masterBank_masterBank=theApp.copyStore('master_pos','store_masterBank','store_masterBank_masterBank');}
store_masterBank_masterBank.proxy.extraParams.limit=25;store_masterBank_masterBank.proxy.extraParams.show_all_text=0;store_masterBank_masterBank.proxy.extraParams.show_choose_text=0;store_masterBank_masterBank.proxy.extraParams.is_dropdown=0;store_masterBank_masterBank.proxy.extraParams.keywords='';var helperGrid=theApp.getHelper('Grid');var selModel_masterBank=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_masterBank').down('#deleteButton_masterBank').setDisabled(selections.length==0);}}});me.pagingtb_masterBank=helperGrid.paging({ds:store_masterBank_masterBank,title:'Bank'});return desktop.createWindow({id:me.id,title:'Bank',width:650,height:380,iconCls:'icon-grid',animCollapse:false,constrainHeader:true,resizable:true,maximized:false,border:0,layout:{type:'fit'},items:[{xtype:'gridpanel',margins:'0 0 0 0',region:'center',store:store_masterBank_masterBank,id:'grid_masterBank',scroll:true,selModel:selModel_masterBank,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'bank_code',text:'Code',width:100},{xtype:'gridcolumn',dataIndex:'bank_name',text:'Name',width:230},{xtype:'gridcolumn',dataIndex:'payment_text',text:'Payment Type',width:150},{xtype:'gridcolumn',dataIndex:'is_active_text',text:'Status Active',width:100}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_masterBank').getSelectionModel().selected;if(getSelection.length>0){me.formType='edit';me.edit_data=rec.data;me.createWindow(me,'add_masterBank');}}},bbar:me.pagingtb_masterBank,dockedItems:[{xtype:'toolbar',dock:'top',items:[{xtype:'textfield',name:'keywords',id:'keywords_masterBank',width:200,labelSeparator:'',emptyText:'Keywords: Bank Name/Code',anchor:'100%',listeners:{specialkey:function(field,e){if(e.getKey()==e.ENTER){me.search_masterBank();}}}},{xtype:'button',text:'Search',itemId:'btnFilterSearch_masterBank',tooltip:'Search',iconCls:'btn-search',handler:function(){me.search_masterBank();}},{xtype:'button',text:'Reset',itemId:'btnResetFilterSearch_masterBank',tooltip:'Reset',iconCls:'btn-reset',handler:function(){me.search_masterBank(true);}},'->',{text:'Add',itemId:'addButton_masterBank',tooltip:'Add Bank',iconCls:'btn-add',handler:function(){me.formType='add';me.createWindow(me,'add_masterBank');}},'-',{text:'Delete',itemId:'deleteButton_masterBank',tooltip:'Delete Bank',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_masterBank').getSelectionModel().selected;if(getSelection.length>0){me.delete_data=getSelection.items[0].data;me.deleteConfirm_masterBank();}else{ExtApp.Msg.info('Please Select Bank!');}}},]}]}],listeners:{boxready:function(){me.search_masterBank();}}});},add_masterBank:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add New ';if(me.formType=='edit'){Titletext='Update ';}
var store_paymentType_masterBank=theApp.getStore('store_paymentType_masterBank',false);if(store_paymentType_masterBank==false){store_paymentType_masterBank=theApp.copyStore('master_pos','store_paymentType','store_paymentType_masterBank');}
store_paymentType_masterBank.proxy.extraParams.limit=99999;return desktop.createWindow({id:me.id+'_add_masterBank',title:Titletext,width:350,height:200,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_masterBank',border:0,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'hidden',name:'form_type_masterBank',value:me.formType},{xtype:'hidden',name:'id'},{xtype:'textfield',name:'bank_code',fieldLabel:'Code',anchor:'60%',allowBlank:false},{xtype:'textfield',name:'bank_name',fieldLabel:'Name',anchor:'100%',allowBlank:false},{xtype:'combobox',name:'payment_id',fieldLabel:'Payment Type',anchor:'100%',store:store_paymentType_masterBank,queryMode:'local',hiddenName:"id",displayField:'payment_type_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listConfig:{emptyText:'No Data',minWidth:250,getInnerTpl:function(){return'{payment_type_name}';}},pageSize:0},{xtype:'checkbox',name:'is_active',fieldLabel:'Status Active',inputValue:'1'}]}],buttons:[{text:'Save',formBind:true,id:'btnSave_masterBank',iconCls:'btn-save',handler:function(){me.save_masterBank();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_masterBank');}}],listeners:{show:function(){var form=Ext.getCmp('form_masterBank').getForm();var myMask=new Ext.LoadMask(Ext.getCmp('form_masterBank'),{msg:"Loading..."});myMask.show();if(me.formType=='edit'){form.setValues(me.edit_data);}else{form.reset();form.findField('is_active').setValue(1);}
store_paymentType_masterBank.load({callback:function(records,operation,success){var payment_id=0;if(me.formType=='edit'){payment_id=me.edit_data.payment_id;}
form.findField('payment_id').setValue(payment_id);myMask.hide();}});}}});}});