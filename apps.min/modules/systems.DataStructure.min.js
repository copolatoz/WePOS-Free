/**
 * Filename: systems.DataStructure.js
 * Generated 2018-08-27 at 06:36:20 PM
 */
Ext.define('ExtApp.modules.systems.model.model_DataStructure',{extend:'Ext.data.Model',alias:'model_DataStructure',fields:[{name:'id',type:'int'},{name:'client_structure_name',type:'string'},{name:'client_structure_nama_show',type:'string'},{name:'client_structure_parent',type:'int'},{name:'client_structure_parent_name',type:'string'},{name:'client_unit_id',type:'int'},{name:'client_unit_name',type:'string'},{name:'role_id',type:'int'},{name:'role_name',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'is_child',type:'int'},{name:'client_structure_notes',type:'string'},{name:'client_structure_order',type:'int'},{name:'updated',type:'date'},{name:'updatedby',type:'string'}]});Ext.define('ExtApp.modules.systems.model.model_DataClientUnit',{extend:'Ext.data.Model',alias:'model_DataClientUnit',fields:[{name:'id',type:'int'},{name:'client_unit_code',type:'string'},{name:'client_unit_name',type:'string'},{name:'client_unit_kode_nama',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'systems/DataClientUnit/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.systems.model.model_roleData',{extend:'Ext.data.Model',alias:'model_roleData',fields:[{name:'id',type:'int'},{name:'role_name',type:'string'},{name:'role_description',type:'string'},{name:'client_id',type:'int'},{name:'client_name',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'systems/role/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.systems.store.store_DataStructure',{extend:'Ext.data.Store',model:'ExtApp.modules.systems.model.model_DataStructure',autoLoad:false,proxy:{type:'ajax',url:appUrl+'systems/DataStructure/gridData',extraParams:{limit:999999},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'client_structure',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.systems.store.store_DataStructure_parent',{extend:'Ext.data.Store',model:'ExtApp.modules.systems.model.model_DataStructure',autoLoad:false,proxy:{type:'ajax',url:appUrl+'systems/DataStructure/gridData',extraParams:{limit:9999,is_dropdown:1},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.systems.store.store_ComboboxDataClientUnit',{extend:'Ext.data.Store',model:'ExtApp.modules.systems.model.model_DataClientUnit',autoLoad:false,remoteSort:true,proxy:{type:'ajax',url:appUrl+'systems/DataClientUnit/gridData',extraParams:{limit:9999,is_dropdown:1},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.systems.store.store_ComboboxRoleData',{extend:'Ext.data.Store',model:'ExtApp.modules.systems.model.model_roleData',autoLoad:false,proxy:{type:'ajax',url:appUrl+'systems/role/gridData',extraParams:{limit:9999,is_dropdown:1},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id_role',totalProperty:'totalCount'}}});Ext.define("ExtApp.modules.systems.view.DataStructure",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var store_DataStructure=theApp.getStore('systems.store_DataStructure');var helperGrid=theApp.getHelper('Grid');var selModel_DataStructure=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_DataStructure').down('#deleteButton_DataStructure').setDisabled(selections.length==0);}}});return desktop.createWindow({id:me.id,title:'Data Structure',width:730,height:400,iconCls:'icon-building',animCollapse:false,constrainHeader:true,resizable:true,maximized:false,border:0,layout:{type:'fit'},items:[{xtype:'gridpanel',id:'grid_DataStructure',store:store_DataStructure,scroll:true,selModel:selModel_DataStructure,columns:[{xtype:'gridcolumn',dataIndex:'id',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'client_structure_nama_show',text:'Name Struktur',width:300},{xtype:'gridcolumn',dataIndex:'client_unit_name',text:'Unit',width:200},{xtype:'gridcolumn',dataIndex:'role_name',text:'Role',width:200},{xtype:'gridcolumn',dataIndex:'client_structure_order',text:'Order',width:40},{xtype:'gridcolumn',dataIndex:'is_active_text',text:'Status',width:70},{xtype:'gridcolumn',dataIndex:'client_structure_notes',text:'Description',width:100}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_DataStructure').getSelectionModel().selected;if(getSelection.length>0){me.formType='edit';me.edit_data=getSelection.items[0].data;me.createWindow(me,'add_DataStructure');}}},dockedItems:[{xtype:'toolbar',dock:'top',items:['->',{text:'Add',itemId:'addButton_DataStructure',tooltip:'Add New Structure',iconCls:'btn-add',handler:function(){me.formType='add';me.createWindow(me,'add_DataStructure');}},'-',{text:'Delete',itemId:'deleteButton_DataStructure',tooltip:'Delete Structure',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_DataStructure').getSelectionModel().selected;if(getSelection.length>0){me.delete_data=getSelection.items[0].data;me.deleteConfirm_DataStructure();}else{ExtApp.Msg.info('Please Select Structure!');}}},'-',{text:'Refresh',itemId:'refreshButton_DataStructure',tooltip:'Refresh Data Structure',iconCls:'btn-refresh',handler:function(){Ext.getCmp('grid_DataStructure').store.load();}}]}]}]});},add_DataStructure:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add Structure ';if(me.formType=='edit'){Titletext='Update Structure: ';}
var store_DataStructure_parent=theApp.getStore('systems.store_DataStructure_parent');var store_ComboboxDataClientUnit=theApp.getStore('systems.store_ComboboxDataClientUnit');var store_ComboboxRoleData=theApp.getStore('systems.store_ComboboxRoleData');return desktop.createWindow({id:me.id+'_add_DataStructure',title:Titletext,width:350,height:300,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_DataStructure',border:0,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'hidden',name:'form_type_DataStructure',value:me.formType},{xtype:'hidden',name:'id'},{xtype:'hidden',name:'client_structure_parent'},{xtype:'combobox',name:'client_structure_parent_combo',fieldLabel:'Parent Structure',anchor:'100%',store:store_DataStructure_parent,queryMode:'local',hiddenName:"client_structure_parent_combo",displayField:'client_structure_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listConfig:{emptyText:'Tidak ada data Structure',minWidth:250,getInnerTpl:function(){return'{client_structure_nama_show}';}},pageSize:0,listeners:{select:{fn:function(c,r,i){Ext.getCmp('form_DataStructure').getForm().findField('client_structure_parent').setValue(c.getValue());}}}},{xtype:'textfield',name:'client_structure_name',fieldLabel:'Name Structure',anchor:'100%',allowBlank:false},{xtype:'combobox',name:'client_unit_id',fieldLabel:'Unit',anchor:'100%',store:store_ComboboxDataClientUnit,queryMode:'local',hiddenName:"client_unit_id",displayField:'client_unit_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listConfig:{emptyText:'Tidak ada data',minWidth:250,getInnerTpl:function(){return'{client_unit_name}';}},pageSize:0},{xtype:'combobox',name:'role_id',fieldLabel:'Role Aplikasi',anchor:'100%',store:store_ComboboxRoleData,queryMode:'local',hiddenName:"role_id",displayField:'role_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listConfig:{emptyText:'Tidak ada data',minWidth:250,getInnerTpl:function(){return'{role_name}';}},pageSize:0},{xtype:'textfield',name:'client_structure_notes',fieldLabel:'Keterangan',anchor:'100%'},{xtype:'textfield',name:'client_structure_order',fieldLabel:'Urutan',anchor:'50%'},{xtype:'checkbox',name:'is_active',fieldLabel:'Status Active',inputValue:'1'}]}],buttons:[{text:'Save',formBind:true,id:'btnSave_DataStructure',iconCls:'btn-save',handler:function(){me.save_DataStructure();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_DataStructure');}}],listeners:{show:function(){var form=Ext.getCmp('form_DataStructure').getForm();var myMask=new Ext.LoadMask(Ext.getCmp('form_DataStructure'),{msg:"Loading..."});myMask.show();if(me.formType=='edit'){form.setValues(me.edit_data);}else{form.reset();form.findField('is_active').setValue(1);form.findField('client_structure_order').setValue(0);}
var extraparams={};if(me.formType=='edit'){extraparams={id_edit:me.edit_data.id};}
store_DataStructure_parent.load({params:extraparams,callback:function(records,operation,success){var client_structure_parent=0;if(me.formType=='edit'){client_structure_parent=me.edit_data.client_structure_parent;}
form.findField('client_structure_parent_combo').select(client_structure_parent);myMask.hide();}});}}});}});